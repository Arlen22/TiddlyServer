{"title":"$:/plugins/tiddlywiki/text-slicer","description":"Tools for slicing text into tiddlers","author":"JeremyRuston","core-version":">=5.0.0","list":"readme docs","version":"5.1.18-prerelease","plugin-type":"plugin","dependents":"","type":"application/json","tiddlers":{"$:/plugins/tiddlywiki/text-slicer/docs/exporters":{"title":"$:/plugins/tiddlywiki/text-slicer/docs/exporters","tags":"$:/plugins/tiddlywiki/text-slicer/docs","caption":"Exporters","text":"Documents can be saved under Node.js, or previewed in the browser.\n\n[TBD]\r\n"},"$:/plugins/tiddlywiki/text-slicer/docs/internals":{"title":"$:/plugins/tiddlywiki/text-slicer/docs/internals","tags":"$:/plugins/tiddlywiki/text-slicer/docs","caption":"Internals","text":"! Introduction\n\nThe slicing process is performed by a simple automaton that scans the document and applies simple declarative rules to yield a collection of tiddlers.\n\nThe automaton processes the incoming XML document starting with the root element and then recursively visits each child node and their children. Actions are triggered as each component of the document is encountered:\n\n* Opening tags of elements\r\n* Closing tags of elements\r\n* Text nodes\n\nComponents are matched against the current set of rules to determine what actions should be performed. They can include a combination of:\n\n* Starting a new tiddler with specified fields\r\n* Rendering the markup for the current tag into the current tiddler\r\n* Appending the content of the current text node to the current tiddler\r\n* Threading tiddlers to their parents using a combination of the `list` and `tags` fields\n\n! Slicing State Data\n\nAs the automaton performs its scan, it maintains the following state information:\n\n* ''chunks'' - an array of tiddlers without titles, addressed by their numeric index. The title field is reused to hold the plain text of the chunk that is later used to generate the final title for the tiddler\r\n* ''currentChunk'' - the numeric index of the chunk currently being filled, or `null` if there is no current chunk\r\n* ''parentStack'' - a stack of parent chunks stored as `{chunk: <chunk-index>, actions: <actions>}`\n\nAt the start, the special document chunk is created and pushed onto the stack of parent chunks\n\n! Slicing Rules\n\nSlicing rules are maintained in tiddlers tagged `$:/tags/text-slicer/slicer-rules` with the following fields:\n\n* ''title'' - title of the tiddler containing the listof rules\r\n* ''name'' - short, human readable name for the set of rules\r\n* ''inherits-from'' - (optional) the ''name'' field of another set of rules that should be inherited as a base\r\n* ''text'' - JSON data as described below\n\nThe JSON data is an array of rules, each of which is an object with the following fields:\n\n* ''selector'' - a selector string identifying the components to be matched by this rule\r\n* ''actions'' - an object describing the actions to be performed when this selector matches a tag\n\n!! Selectors\n\nThe selector format is a simplified form of CSS selectors. They are specified as follows:\n\n* A ''selector'' is a list of one or more ''match expressions'' separated by commas. The rule is triggered if any of the match expressions produce a positive match\r\n* A ''match expression'' is a list of one or element ''tag names'' separated by spaces. The rule is triggered if the final tag name in the list matches the tag of the current element, and all of the preceding tags in the expression exist as ancestors of the current element in the specified order (but not necessarily as immediate children of one another)\r\n* A ''tag name'' is the textual name of an element\r\n* Tag names in match expressions may optionally be separated by a `>` sign surrounded by spaces to impose the requirement that the left hand element be the immediate parent of the right hand element\n\n!!! Example Selectors\n\nThis XML document will be used to illustrate some examples:\n\n```\r\n<a>\r\n  <b>\r\n    <d>one</d>\r\n  </b>\r\n  <c>\r\n    <d>two</d>\r\n    <e>\r\n      three\r\n      <e>\r\n        four\r\n      </e>\r\n    </e>\r\n  </c>\r\n</a>\n\n```\n\n|!Selector |!Matches |\r\n|b |Matches the single `<b>` element |\r\n|d |Matches both of the two `<d>` elements |\r\n|c,d |Matches the `<c>` element and both of the two `<d>` elements |\r\n|c d |Matches the second of the two `<d>` elements |\r\n|a d |Matches both of the two `<d>` elements |\r\n|a > d |Doesn't match anything |\r\n|e |Matches both of the two `<e>` elements |\r\n|c > e |Matches the outermost of the two `<e>` elements |\r\n|e > e |Matches the innermost of the two `<e>` elements |\n\n!! Actions\n\nThe ''action'' property of a slicer rule is an object that can have any of the following optional fields:\n\n* ''startNewChunk'' - causes a new chunk to be started on encountering an opening tag. The value is an object containing the fields to be assigned to the new chunk\r\n* ''isParent'' - causes the new chunk to be marked as a child of the current chunk (boolean flag; only applies if ''startNewChunk'' is set)\r\n* ''headingLevel'' - arrange heading parents according to level (numerical index; only applies if ''startNewChunk'' and ''isParent'' are set)\r\n* ''dontRenderTag'' - disables the default rendering of opening and closing tags to the current chunk. By default the tags are rendered as XML tags, but this can be overridden via ''markup'' (boolean; defaults to ''false'')\r\n* ''isImage'' - identifies an element as representing an HTML image element, with special processing for the ''src'' attribute\r\n* ''markup'' - optional object with either or both of `{wiki: {prefix: <str>,suffix: <str>}}` and `{html: {prefix: <str>,suffix: <str>}}` allowing the rendered tags to be customised\r\n"},"$:/plugins/tiddlywiki/text-slicer/docs/model":{"title":"$:/plugins/tiddlywiki/text-slicer/docs/model","tags":"$:/plugins/tiddlywiki/text-slicer/docs","caption":"Document Model","text":"Individual tiddlers are created for each heading, paragraph and list item. They are linked together into a hierarchical outline using lists.\n\nFor example, consider a tiddler titled ''Example'' containing this simple text:\n\n<<<\r\n! This is a heading\n\nThis is a paragraph.\n\n* And the first list item\r\n* Second list item\r\n<<<\n\nIt will be sliced up into:\n\n* a tiddler for the overall document\r\n** a tiddler for the heading\r\n*** a tiddler for the paragraph\r\n*** a tiddler for the list\r\n**** and a tiddler for each list item\n\nThese tiddlers are bound together using lists: the parent tiddler has a ''list'' field that lists each child in the correct order.\n\n!! Slicing Process\n\nSlicing generates the following component tiddlers.\n\nTiddler titles are generated automatically in most cases (but can subsequently be changed manually). The automatically generated title is made up of concatenating the following elements:\n\n* root text (e.g. ''para'')\r\n* a dash ''-''\r\n* the first few words of the text of the item (up to 40 characters), separated with dashes ''-''\r\n* if necessary, a dash ''-'' and a numerical index to make the title unique\n\nFor example, ''para-how-to-use-pentagonal-tiles 23''.\n\nAny CSS classes used in the original document are assigned as tags to the associated tiddlers.\n\n!!! Document\n\nThe document itself is represented by a tiddler with the following fields:\n\n* ''toc-type'': the text \"document\"\r\n* ''title'': the text ''\"Sliced up \"'' plus the title of the tiddler that was sliced\r\n* ''text'': Available for comments about the document\r\n* ''list'': ordered list of tiddlers making up the root level of this document\n\n!!! Headings\n\nTiddlers representing headings have the following fields:\n\n* ''toc-type'': the text \"heading\"\r\n* ''toc-heading-level'': the heading level \"h1\", \"h2\", \"h3\" etc.\r\n* ''title'': an automatically generated unique title\r\n* ''text'': the text of the heading\r\n* ''list'': ordered list of tiddlers tagged with this heading (i.e. the child headings, paragraphs and lists displayed under this heading)\r\n** In addition, any CSS classes found in the HTML are converted into tags\n\n!!! Paragraphs\n\nTiddlers representing paragraphs have the following fields:\n\n* ''toc-type'': the text \"paragraph\"\r\n* ''title'': an automatically generated unique title\r\n* ''text'': the text of the paragraph\r\n* ''tags'': any CSS classes found in the HTML are converted into tags\n\n!!! Lists\n\nLists are represented by several tiddlers: one for the list itself, and one for each item in the list.\n\nThe tiddler representing the list itself has the following fields:\n\n* ''toc-type'': the text \"list\"\r\n* ''toc-list-type'': the text \"ul\" or \"ol\"\r\n* ''toc-list-filter'': the default filter used to generate the titles of the list items\r\n* ''title'': an automatically generated unique title\r\n* ''list'': ordered list of titles of tiddlers representing the items in this list\r\n* ''tags'': any CSS classes found in the HTML are converted into tags\n\nThe tiddlers representing items within the list have the following fields:\n\n* ''toc-type'': the text \"item\"\r\n* ''title'': an automatically generated unique title\r\n* ''text'': the text of the list item\r\n* ''tags'': any CSS classes found in the HTML are converted into tags\n\n!!! Definition lists\n\nDefinition lists are represented by several tiddlers: one for the definition list itself, and one for each term and definition in the list.\n\nThe tiddler representing the definition list itself has the following fields:\n\n* ''toc-type'': the text \"def-list\"\r\n* ''toc-list-filter'': the default filter used to generate the titles of the definition list items\r\n* ''title'': an automatically generated unique title\r\n* ''list'': ordered list of titles of tiddlers representing the items (terms and/or definition) in the definition list\r\n* ''tags'': any CSS classes found in the HTML are converted into tags\n\nThe tiddlers representing terms within the definition list have the following fields:\n\n* ''toc-type'': the text \"term\"\r\n* ''title'': an automatically generated unique title\r\n* ''text'': the text of the definition list term\r\n* ''tags'': any CSS classes found in the HTML are converted into tags\n\nThe tiddlers representing definitions within the definition list have the following fields:\n\n* ''toc-type'': the text \"definition\"\r\n* ''title'': an automatically generated unique title\r\n* ''text'' : the text of the definition list definition\r\n* ''tags'': any CSS classes found in the HTML are converted into tags\n\n!!! Images\n\nTiddlers representing images have the following fields:\n\n* ''toc-type'': the text \"image\"\r\n* ''title'': an automatically generated unique title\r\n* ''type'': appropriate content type for the image (eg \"image/jpeg\")\n\n!!! Notes\n\nNotes are available during editing but hidden for static renderings. The slicing mechanism does not generate notes; they can only be subsequently added manually. Tiddlers representing notes have the following fields:\n\n* ''toc-type'': the text \"note\"\r\n* ''title'': an automatically generated unique title\r\n* ''text'': the text of the note\r\n* ''tags'': any CSS classes found in the HTML are converted into tags\r\n"},"$:/plugins/tiddlywiki/text-slicer/docs/preview":{"title":"$:/plugins/tiddlywiki/text-slicer/docs/preview","tags":"$:/plugins/tiddlywiki/text-slicer/docs","caption":"Preview","text":"The document preview column appears at the left side of the screen. The content of headings can be collapsed and expanded to help navigation. Clicking on a tiddler opens the corresponding tiddler in the main story river.\n\nClicking ''Show toolbar'' causes each tiddler to be preceded by a toolbar showing the underlying title. It can be edited directly to rename the tiddler. References to the tiddler in the ''tags'' and ''list'' are automatically updated to reflect the change, but note that links to the tiddler will not be automatically changed.\n\nThe following theme tweaks should be applied to enable the preview column:\n\n* Set [[story left position|$:/themes/tiddlywiki/vanilla/metrics/storyleft]] to ''400px'' (or more)\r\n* It is recommended to also set the [[sidebar layout|$:/themes/tiddlywiki/vanilla/options/sidebarlayout]] to ''fluid-fixed''.\n\nTo preview the entire document in a separate window, locate it in the preview column and click the button labelled \"View document\". The document will open in plain text in a new window. The window will be automatically updated as you work on the document.\r\n"},"$:/plugins/tiddlywiki/text-slicer/docs/usage":{"title":"$:/plugins/tiddlywiki/text-slicer/docs/usage","tags":"$:/plugins/tiddlywiki/text-slicer/docs","caption":"Usage","text":"The tool can slice any tiddler that can be rendered as HTML, including both WikiText and HTML itself.\n\nDocuments created with Microsoft Word will need to be first converted to HTML. The library [[mammoth.js|https://github.com/mwilliamson/mammoth.js]] is recommended for this purpose.\n\n!! Browser\n\nIn the browser, you can slice a monolithic document tiddler using the slicer toolbar button.\n\n!! Node.js\n\nThe `--slice` command allows a tiddler to be sliced under Node.js:\n\n```\r\ntiddlywiki mywiki --slice SourceDocument --build index\r\n```\r\n"},"$:/plugins/tiddlywiki/text-slicer/docs":{"title":"$:/plugins/tiddlywiki/text-slicer/docs","list":"$:/plugins/tiddlywiki/text-slicer/docs/usage $:/plugins/tiddlywiki/text-slicer/docs/preview $:/plugins/tiddlywiki/text-slicer/docs/model $:/plugins/tiddlywiki/text-slicer/docs/exporters $:/plugins/tiddlywiki/text-slicer/docs/internals","text":"! Introduction\n\nThis plugin contains tools to help work with documents that are structured as a hierarchical outline of tiddlers.  The structural relationships within the document are expressed through the `list` and `tags` fields: for example, headings have a list specifying the chunks of content to be shown under the heading.\n\nThe major components within the text slicer plugin include:\n\n* ''the slicer'', a tool that slices up an existing monolithic document according to the headings, lists and paragraphs. It is available as a toolbar button for the browser, or as a command for use under Node.js\r\n* ''document preview column'', a new sidebar on the left that shows the full text of any documents in the wiki and allows individual tiddlers to be opened with a click\r\n* ''templates'' for previewing and exporting the individual documents as HTML files\n\nMinor components include:\n\n* a new `list-children` filter that returns all the descendents listed in the `list` field of the selected tiddlers\r\n* a new canned filter for [[advanced search|$:/AdvancedSearch]] that lists orphans tiddlers that are not part of any document\n\n<<tabs \"[all[tiddlers+shadows]tag[$:/plugins/tiddlywiki/text-slicer/docs]!has[draft.of]]\" \"$:/plugins/tiddlywiki/text-slicer/docs/usage\">>\r\n"},"$:/plugins/tiddlywiki/text-slicer/readme":{"title":"$:/plugins/tiddlywiki/text-slicer/readme","text":"This plugin contains tools to help slice up long texts into individual tiddlers. It currently works directly with XHTML documents and with Microsoft Word compatible DOCX documents via conversion to HTML.\n\nIt is an expression of the philosophy of TiddlyWiki: that text is easier to re-use and work with if it is sliced up into separate chunks that can be independently manipulated, and then woven back together to make up stories and narratives for publication.\n\n"},"$:/plugins/tiddlywiki/text-slicer/icon":{"title":"$:/plugins/tiddlywiki/text-slicer/icon","tags":"$:/tags/Image","text":"<svg class=\"tc-image-text-slicer tc-image-button\" width=\"22pt\" height=\"22pt\" viewBox=\"0 0 128 128\">\r\n    <g fill-rule=\"evenodd\" sketch:type=\"MSPage\">\r\n        <path d=\"M64,0 L118.5596,32 L118.5596,96 L64,128 L9.44039956,96 L9.44039956,32 L64,0 Z\" ></path>\r\n        <g transform=\"translate(32.000000, 32.000000) scale(2.19)\" fill=\"#ffffff\">\r\n            {{$:/plugins/tiddlywiki/text-slicer/images/text-slicer-icon}}\r\n        </g>\r\n    </g>\r\n</svg>"},"$:/plugins/tiddlywiki/text-slicer/images/text-slicer-icon":{"title":"$:/plugins/tiddlywiki/text-slicer/images/text-slicer-icon","tags":"$:/tags/Image","text":"<svg class=\"tc-image-text-slicer tc-image-button\" width=\"22pt\" height=\"22pt\" viewBox=\"0 0 128 128\">\r\n\t<g fill-rule=\"evenodd\">\r\n\t\t<path d=\"M78.3637366,56.1312577 L78.3637366,60.2285796 L26.7489717,26.7095593 C23.9558586,24.8956905 23.1577753,21.1490577 24.9741388,18.3521031 C26.7898442,15.5561619 30.5337016,14.7576591 33.3309445,16.5742099 L87.6340125,51.8390346 L84.9731806,51.8390346 L103.852266,39.5788135 L105.182681,41.6274744 L104.070376,43.8022835 C102.858368,43.1824026 101.719662,42.4138485 100.675491,41.5061647 C93.6569185,35.4050129 92.9012893,24.7795163 98.9918187,17.7731637 C105.082348,10.766811 115.709601,10.0363032 122.728174,16.137455 C129.746746,22.2386068 130.502375,32.8641034 124.411846,39.870456 C123.229956,41.2300649 121.856251,42.3760135 120.416666,43.2314984 L94.2434565,60.2285796 L94.2434565,56.1312577 L120.765587,73.3549304 C121.152097,73.6059335 121.506081,73.898207 121.822516,74.2262669 L120.064365,75.9221214 L121.489555,73.938223 C121.915739,74.2443848 122.328975,74.5712591 122.728174,74.9182775 C129.746746,81.0194293 130.502375,91.6449259 124.411846,98.6512786 C118.321316,105.657631 107.694063,106.388139 100.675491,100.286987 C93.6569185,94.1858354 92.9012893,83.5603389 98.9918187,76.5539862 C100.441592,74.8862128 102.178627,73.5416182 104.115112,72.5685999 L105.211846,74.7513028 L103.88143,76.7999638 L84.9731806,64.5208027 L87.6340125,64.5208027 L61.3662147,81.57931 L61.3662147,67.1695775 L78.3637366,56.1312577 Z M114.533131,83.6707925 L115.961891,81.689464 L114.933771,83.9053132 C114.675216,83.7853476 114.424622,83.6467924 114.183613,83.4902793 L113.644945,83.1404643 L114.975362,81.0918038 L113.881545,83.2759699 C111.959385,82.3133637 109.605897,82.7611681 108.179792,84.4017143 C106.463272,86.3763445 106.676536,89.3752164 108.660203,91.0995921 C110.643871,92.8239678 113.643238,92.617794 115.359758,90.6431638 C117.076278,88.6685336 116.863014,85.6696617 114.879347,83.945286 C114.767376,83.8479516 114.651892,83.7564326 114.533131,83.6707925 Z M115.359758,31.8623412 C117.076278,29.8877111 116.863014,26.8888391 114.879347,25.1644635 C112.89568,23.4400878 109.896312,23.6462616 108.179792,25.6208918 C106.463272,27.5955219 106.676536,30.5943939 108.660203,32.3187696 C110.643871,34.0431452 113.643238,33.8369714 115.359758,31.8623412 Z\" fill-rule=\"nonzero\"></path>\r\n\t\t<g transform=\"translate(0.000000, 46.000000)\">\r\n\t\t\t<path d=\"M62.9632954,19.5390625 L62.984127,19.5390625 L62.984127,76.87441 C62.984127,79.7051952 60.6450077,82 57.7588318,82 L5.49996847,82 C2.61411765,82 0.274673329,79.7050809 0.274673329,76.87441 L0.274673329,5.12559005 C0.274673329,2.29480483 2.61379258,0 5.49996847,0 L42.7341992,0 L42.7341992,0.0129302741 C44.1445002,-0.0458264988 45.5745556,0.452971616 46.6523962,1.51002434 L61.4328365,16.0053998 C62.4299816,16.9833134 62.9403234,18.2577109 62.9632954,19.5390625 L62.9632954,19.5390625 Z M42.7341992,5.125 L5.50046113,5.125 L5.50046113,76.875 L57.7583392,76.875 L57.7583392,19.5390625 L47.9602131,19.5390625 C45.0739653,19.5390625 42.7341992,17.2466672 42.7341992,14.4138408 L42.7341992,5.125 Z\" ></path>\r\n\t\t\t<rect x=\"10.7262489\" y=\"23.0625\" width=\"41.8063024\" height=\"5.125\" rx=\"2.5625\"></rect>\r\n\t\t\t<rect x=\"10.7262489\" y=\"33.3125\" width=\"41.8063024\" height=\"5.125\" rx=\"2.5625\"></rect>\r\n\t\t\t<rect x=\"10.7262489\" y=\"43.5625\" width=\"41.8063024\" height=\"5.125\" rx=\"2.5625\"></rect>\r\n\t\t\t<rect x=\"10.7262489\" y=\"53.8125\" width=\"41.8063024\" height=\"5.125\" rx=\"2.5625\"></rect>\r\n\t\t\t<rect x=\"10.7262489\" y=\"64.0625\" width=\"41.8063024\" height=\"5.125\" rx=\"2.5625\"></rect>\r\n\t\t\t<rect x=\"10.7262489\" y=\"12.8125\" width=\"26.128939\" height=\"5.125\" rx=\"2.5625\"></rect>\r\n\t\t</g>\r\n\t</g>\r\n</svg>\r\n"},"$:/language/Help/slice":{"title":"$:/language/Help/slice","description":"Slice a hierarchical document into individual tiddlers","text":"Slices the specified tiddler\n\n```\r\n--slice <source-title> [<dest-title>] [<slicer-rules>] [<output-mode>]\r\n```\n\n* ''source-title'': Title of the tiddler to be sliced\r\n* ''dest-title'': Base title for the generated output tiddlers\r\n* ''slicer-rules'': Name of the slicer rules to use for the operation (see below)\r\n* ''output-mode'': \"html\" vs \"wiki\"\n\nThe plugin comes with several built-in sets of slicer rules:\n\n* //html-by-paragraph//: Slice every paragraph into a separate tiddler, threaded by heading\r\n* //html-by-heading//: Slice every heading into separate threaded tiddlers\r\n* //html-plain-paragraphs//: Slice every paragraph into a separate tiddler, without formatting or headings\n\nAdvanced users can create or edit their own slicer rules for precise control over the conversion process\r\n"},"$:/plugins/tiddlywiki/text-slicer/modules/commands/slice.js":{"title":"$:/plugins/tiddlywiki/text-slicer/modules/commands/slice.js","text":"/*\\\r\ntitle: $:/plugins/tiddlywiki/text-slicer/modules/commands/slice.js\r\ntype: application/javascript\r\nmodule-type: command\r\n\r\nCommand to slice a specified tiddler\r\n\r\n\\*/\r\n(function(){\r\n\r\n/*jslint node: true, browser: true */\r\n/*global $tw: false */\r\n\"use strict\";\r\n\r\nvar widget = require(\"$:/core/modules/widgets/widget.js\"),\r\n\ttextSlicer = require(\"$:/plugins/tiddlywiki/text-slicer/modules/slicer.js\");\r\n\r\nexports.info = {\r\n\tname: \"slice\",\r\n\tsynchronous: false\r\n};\r\n\r\nvar Command = function(params,commander,callback) {\r\n\tthis.params = params;\r\n\tthis.commander = commander;\r\n\tthis.callback = callback;\r\n};\r\n\r\nCommand.prototype.execute = function() {\r\n\tif(this.params.length < 1) {\r\n\t\treturn \"Missing parameters\";\r\n\t}\r\n\tvar self = this,\r\n\t\twiki = this.commander.wiki,\r\n\t\tsourceTitle = this.params[0],\r\n\t\tdestTitle = this.params[1],\r\n\t\tslicerRules = this.params[2],\r\n\t\toutputMode = this.params[3],\r\n\t\tslicer = new textSlicer.Slicer({\r\n\t\t\tsourceTiddlerTitle: sourceTitle,\r\n\t\t\tbaseTiddlerTitle: destTitle,\r\n\t\t\tslicerRules: slicerRules,\r\n\t\t\toutputMode: outputMode,\r\n\t\t\twiki: wiki,\r\n\t\t\tcallback: function(err,tiddlers) {\r\n\t\t\t\tif(err) {\r\n\t\t\t\t\treturn self.callback(err);\r\n\t\t\t\t}\r\n\t\t\t\twiki.addTiddlers(tiddlers);\r\n\t\t\t\tself.callback();\t\r\n\t\t\t}\r\n\t\t});\r\n\treturn null;\r\n};\r\n\r\nexports.Command = Command;\r\n\r\n})();\r\n","type":"application/javascript","module-type":"command"},"$:/core/modules/filters/list-children.js":{"title":"$:/core/modules/filters/list-children.js","text":"/*\\\r\ntitle: $:/core/modules/filters/list-children.js\r\ntype: application/javascript\r\nmodule-type: filteroperator\r\n\r\nFilter operator returning all the descendents of a tiddler listed in the \"list\" field\r\n\r\n\\*/\r\n(function(){\r\n\r\n/*jslint node: true, browser: true */\r\n/*global $tw: false */\r\n\"use strict\";\r\n\r\n/*\r\nExport our filter function\r\n*/\r\nexports[\"list-children\"] = function(source,operator,options) {\r\n\tvar children = {},\r\n\t\tprocessTiddler = function(title) {\r\n\t\t\tvar tiddler = options.wiki.getTiddler(title);\r\n\t\t\tif(tiddler && !$tw.utils.hop(children,title)) {\r\n\t\t\t\tchildren[title] = true;\r\n\t\t\t\tvar list = options.wiki.getTiddlerList(title,operator.operand);\r\n\t\t\t\tlist.forEach(function(listItem) {\r\n\t\t\t\t\tif(!$tw.utils.hop(children,listItem)) {\r\n\t\t\t\t\t\tprocessTiddler(listItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\tsource(function(tiddler,title) {\r\n\t\tprocessTiddler(title);\r\n\t});\r\n\treturn Object.keys(children);\r\n};\r\n\r\n})();\r\n","type":"application/javascript","module-type":"filteroperator"},"$:/plugins/tiddlywiki/text-slicer/slicer-rules/html-by-heading.json":{"title":"$:/plugins/tiddlywiki/text-slicer/slicer-rules/html-by-heading.json","name":"html-by-heading","caption":"By Heading (HTML)","description":"One tiddler per heading, threaded (HTML)","inherits-from":"html-by-paragraph","type":"application/json","tags":"$:/tags/text-slicer/slicer-rules","text":"[\r\n\t{\r\n\t\t\"selector\": \"address,center,fieldset,form,hr,iframe,isindex,noframes,noscript,ol,ul,li,pre,table\",\r\n\t\t\"actions\": {}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"blockquote\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"<<<\\n\",\r\n\t\t\t\t\t\"suffix\": \"<<<\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"dd\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"\\n: \",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"dl\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"\\n\",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"dt\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"\\n; \",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h1\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h1\"\r\n\t\t\t},\r\n\t\t\t\"mergeNext\": true,\r\n\t\t\t\"setCaption\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 1,\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"! \",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h2\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h2\"\r\n\t\t\t},\r\n\t\t\t\"mergeNext\": true,\r\n\t\t\t\"setCaption\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 2,\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"!! \",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h3\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h3\"\r\n\t\t\t},\r\n\t\t\t\"mergeNext\": true,\r\n\t\t\t\"setCaption\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 3,\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"!!! \",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h4\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h4\"\r\n\t\t\t},\r\n\t\t\t\"mergeNext\": true,\r\n\t\t\t\"setCaption\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 4,\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"!!!! \",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h5\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h5\"\r\n\t\t\t},\r\n\t\t\t\"mergeNext\": true,\r\n\t\t\t\"setCaption\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 5,\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"!!!!! \",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h6\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h6\"\r\n\t\t\t},\r\n\t\t\t\"mergeNext\": true,\r\n\t\t\t\"setCaption\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 6,\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"!!!!!! \",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"p\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"\",\r\n\t\t\t\t\t\"suffix\": \"\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"*\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true\r\n\t\t}\r\n\t}\r\n]\r\n"},"$:/plugins/tiddlywiki/text-slicer/slicer-rules/html-by-paragraph.json":{"title":"$:/plugins/tiddlywiki/text-slicer/slicer-rules/html-by-paragraph.json","name":"html-by-paragraph","caption":"By Paragraph (HTML)","description":"One tiddler per paragraph, threaded by heading (HTML)","type":"application/json","tags":"$:/tags/text-slicer/slicer-rules","text":"[\r\n\t{\r\n\t\t\"selector\": \"address,center,fieldset,form,hr,iframe,isindex,noframes,noscript,pre,table\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"paragraph\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"blockquote\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"paragraph\"\r\n\t\t\t},\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"<<<\\n\",\r\n\t\t\t\t\t\"suffix\": \"<<<\\n\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"body,div,head,html,span\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"dd\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"definition\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"dl\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"def-list\",\r\n\t\t\t\t\"toc-list-filter\": \"[list<currentTiddler>!has[draft.of]]\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"dt\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"term\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"em,i\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"//\",\r\n\t\t\t\t\t\"suffix\": \"//\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h1\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 1,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h1\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h2\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 2,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h2\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h3\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 3,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h3\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h4\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 4,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h4\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h5\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 5,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h5\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"h6\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"headingLevel\": 6,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"heading\",\r\n\t\t\t\t\"toc-heading-level\": \"h6\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"img\",\r\n\t\t\"actions\": {\r\n\t\t\t\"isImage\": true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"li\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"item\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"ol\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"list\",\r\n\t\t\t\t\"toc-list-type\": \"ol\",\r\n\t\t\t\t\"toc-list-filter\": \"[list<currentTiddler>!has[draft.of]]\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"p\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"paragraph\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"strike\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"~~\",\r\n\t\t\t\t\t\"suffix\": \"~~\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"strong,b\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"''\",\r\n\t\t\t\t\t\"suffix\": \"''\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"sub\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \",,\",\r\n\t\t\t\t\t\"suffix\": \",,\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"sup\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"^^\",\r\n\t\t\t\t\t\"suffix\": \"^^\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"head > title\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"paragraph\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"u\",\r\n\t\t\"actions\": {\r\n\t\t\t\"markup\": {\r\n\t\t\t\t\"wiki\": {\r\n\t\t\t\t\t\"prefix\": \"__\",\r\n\t\t\t\t\t\"suffix\": \"__\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"ul\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"isParent\": true,\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"list\",\r\n\t\t\t\t\"toc-list-type\": \"ul\",\r\n\t\t\t\t\"toc-list-filter\": \"[list<currentTiddler>!has[draft.of]]\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"*\",\r\n\t\t\"actions\": {}\r\n\t}\r\n]"},"$:/plugins/tiddlywiki/text-slicer/slicer-rules/html-linear.json":{"title":"$:/plugins/tiddlywiki/text-slicer/slicer-rules/html-linear.json","name":"html-linear","caption":"Linear (HTML)","description":"One tiddler per paragraph in a single linear thread (HTML)","type":"application/json","tags":"$:/tags/text-slicer/slicer-rules","text":"[\r\n\t{\r\n\t\t\"selector\": \"li > p\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"p\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"paragraph\"\r\n\t\t\t},\r\n\t\t\t\"dontRenderTag\": true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"a\",\r\n\t\t\"actions\": {\r\n\t\t\t\"isAnchor\": true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"address,blockquote,center,dl,dt,fieldset,form,h1,h2,h3,h4,h5,h6,hr,iframe,isindex,noframes,noscript,ol,pre,table,ul\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"paragraph\"\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"br,caption,code,col,colgroup,em,i,dd,li,strike,strong,b,sub,sup,u,tbody,td,tfoot,th,thead,tr\",\r\n\t\t\"actions\": {\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"img\",\r\n\t\t\"actions\": {\r\n\t\t\t\"isImage\": true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"head\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true,\r\n\t\t\t\"discard\": true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"*\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true\r\n\t\t}\r\n\t}\r\n]"},"$:/plugins/tiddlywiki/text-slicer/slicer-rules/html-plain-paragraphs.json":{"title":"$:/plugins/tiddlywiki/text-slicer/slicer-rules/html-plain-paragraphs.json","name":"html-plain-paragraphs","caption":"Plain Paragraphs (HTML)","description":"One tiddler per paragraph, without formatting (HTML)","type":"application/json","tags":"$:/tags/text-slicer/slicer-rules","text":"[\r\n\t{\r\n\t\t\"selector\": \"address,blockquote,center,dd,dt,h1,h2,h3,h4,h5,h6,li,p\",\r\n\t\t\"actions\": {\r\n\t\t\t\"startNewChunk\": {\r\n\t\t\t\t\"toc-type\": \"paragraph\"\r\n\t\t\t},\r\n\t\t\t\"dontRenderTag\": true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"selector\": \"*\",\r\n\t\t\"actions\": {\r\n\t\t\t\"dontRenderTag\": true\r\n\t\t}\r\n\t}\r\n]\r\n"},"$:/plugins/tiddlywiki/text-slicer/modules/slicer.js":{"title":"$:/plugins/tiddlywiki/text-slicer/modules/slicer.js","text":"/*\\\r\ntitle: $:/plugins/tiddlywiki/text-slicer/modules/slicer.js\r\ntype: application/javascript\r\nmodule-type: library\r\n\r\nSlice a tiddler or DOM document into individual tiddlers\r\n\r\nvar slicer = new textSlicer.Slicer(doc,{\r\n\t\tslicerRules: JSON data defining slicer rules -or- title of rules taken from tiddlers tagged $:/tags/text-slicer/slicer-rules\r\n\t\tsourceTiddlerTitle: tiddler to slice -or-\r\n\t\tsourceText: text to slice\r\n\t\toutputMode: \"html\" (default) -or- \"wiki\"\r\n\t\tbaseTiddlerTitle: \"MySlicedTiddlers-\"\r\n\t\trole: \"sliced-content\"\r\n\t\tcallback: function(err,tiddlers)\r\n\t});\r\n\r\n\\*/\r\n(function(){\r\n\r\n/*jslint node: true, browser: true */\r\n/*global $tw: false */\r\n\"use strict\";\r\n\r\nfunction Slicer(options) {\r\n\t// Quick tests\r\n\tthis.testSlicerRuleMatching();\r\n\t// Marshal parameters\r\n\tthis.sourceTiddlerTitle = options.sourceTiddlerTitle;\r\n\tthis.sourceText = options.sourceText;\r\n\tthis.wiki = options.wiki;\r\n\tthis.role = options.role || \"sliced-html\";\r\n\tthis.outputMode = options.outputMode || \"html\";\r\n\tthis.escapeWikiText = options.escapeWikiText || false;\r\n\tthis.callbackFn = options.callback;\r\n\t// Get the slicer rules\r\n\tvar nameSlicerRules = null;\r\n\tif(!options.slicerRules) {\r\n\t\tnameSlicerRules = \"html-by-paragraph\";\r\n\t\tthis.slicerRules = this.loadSlicerRules(nameSlicerRules);\r\n\t} else if(typeof options.slicerRules === \"string\") {\r\n\t\tnameSlicerRules = options.slicerRules;\r\n\t\tthis.slicerRules = this.loadSlicerRules(nameSlicerRules);\r\n\t} else {\r\n\t\tthis.slicerRules = options.slicerRules;\r\n\t}\r\n\t// Set up the base tiddler title\r\n\tthis.baseTiddlerTitle = this.getBaseTiddlerTitle(options.baseTiddlerTitle);\r\n\t// Initialise state\r\n\tthis.namespaces = {}; // Hashmap of URLs\r\n\tthis.chunks = []; // Array of tiddlers without titles, addressed by their index. We use the title field to hold the plain text content\r\n\tthis.currentChunk = null; // Index of the chunk currently being written to\r\n\tthis.parentStack = []; // Stack of parent chunks {chunk: chunk index,actions:}\r\n\tthis.elementStack = []; // Stack of {tag:,isSelfClosing:,actions:}\r\n\tthis.titleCounts = {}; // Hashmap of counts of prefixed titles that have been issued\r\n\t// Set up the document tiddler as top level heading\r\n\tthis.chunks.push({\r\n\t\t\"toc-type\": \"document\",\r\n\t\ttitle: this.baseTiddlerTitle,\r\n\t\ttext: \"<div class='tc-table-of-contents'><<toc-selective-expandable \\\"\\\"\\\"\" + this.baseTiddlerTitle + \"document\\\"\\\"\\\">></div>\",\r\n\t\tlist: [],\r\n\t\ttags: [],\r\n\t\trole: this.role,\r\n\t\t\"slicer-rules\": nameSlicerRules,\r\n\t\t\"slicer-output-mode\": this.outputMode\r\n\t});\r\n\tthis.parentStack.push({chunk: 0, actions: this.getMatchingSlicerRuleActions(\"(document)\")});\r\n\tthis.insertPrecedingChunk({\r\n\t\t\"toc-type\": \"anchor\",\r\n\t\t\"title\": this.baseTiddlerTitle + \"-anchor-\"\r\n\t});\r\n\t// Set up the parser\r\n\tvar sax = require(\"$:/plugins/tiddlywiki/sax/sax.js\");\r\n\tthis.sax = sax.parser(false,{\r\n\t\txmlns: true,\r\n\t\tlowercase: true\r\n\t});\r\n\tthis.sax.onerror = this.onError.bind(this);\r\n\tthis.sax.onopennamespace = this.onOpenNamespace.bind(this);\r\n\tthis.sax.onclosenamespace = this.onCloseNamespace.bind(this);\r\n\tthis.sax.onopentag = this.onOpenTag.bind(this);\r\n\tthis.sax.onclosetag = this.onCloseTag.bind(this);\r\n\tthis.sax.ontext = this.onText.bind(this);\r\n\tthis.sax.onend = this.onEnd.bind(this);\r\n\t// Start streaming the data\r\n\tthis.sax.write(this.getSourceText());\r\n\tthis.sax.close();\r\n}\r\n\r\nSlicer.prototype.callback = function(err,tiddlers) {\r\n\tvar self = this;\r\n\t$tw.utils.nextTick(function() {\r\n\t\tself.callbackFn(err,tiddlers);\r\n\t});\r\n};\r\n\r\nSlicer.prototype.loadSlicerRules = function(name) {\r\n\t// Collect the available slicer rule tiddlers\r\n\tvar self = this,\r\n\t\ttitles = this.wiki.getTiddlersWithTag(\"$:/tags/text-slicer/slicer-rules\"),\r\n\t\ttiddlers = {},\r\n\t\trules = {},\r\n\t\truleNames = [];\r\n\ttitles.forEach(function(title) {\r\n\t\tvar tiddler = self.wiki.getTiddler(title);\r\n\t\ttiddlers[tiddler.fields.name] = tiddler;\r\n\t\trules[tiddler.fields.name] = self.wiki.getTiddlerData(title,[]);\r\n\t});\r\n\t// Follow the inheritance trail to get a stack of slicer rule names\r\n\tvar n = name;\r\n\tdo {\r\n\t\truleNames.push(n);\r\n\t\tn = tiddlers[n] && tiddlers[n].fields[\"inherits-from\"];\r\n\t} while(n && ruleNames.indexOf(n) === -1);\r\n\t// Concatenate the slicer rules\r\n\trules = ruleNames.reduce(function(accumulator,name) {\r\n\t\treturn accumulator.concat(rules[name]);\r\n\t},[]);\r\n\treturn rules;\r\n};\r\n\r\nSlicer.prototype.getMatchingSlicerRuleActions = function(name) {\r\n\tvar rule = this.searchSlicerRules(name,this.slicerRules,this.elementStack);\r\n\tif(!rule) {\r\n\t\treturn {};\r\n\t} else {\r\n\t\treturn rule.actions;\r\n\t}\r\n};\r\n\r\nSlicer.prototype.testSlicerRuleMatching = function() {\r\n\tvar tests = [\r\n\t\t\t{\r\n\t\t\t\ttest: this.searchSlicerRules(\"title\",[\r\n\t\t\t\t\t\t{selector: \"title,head,body\", rules: true},\r\n\t\t\t\t\t\t{selector: \"body\", rules: true}\r\n\t\t\t\t\t],[\r\n\t\t\t\t\t\t{tag:\"head\"}\r\n\t\t\t\t\t]),\r\n\t\t\t\tresult: \"title,head,body\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttest: this.searchSlicerRules(\"body\",[\r\n\t\t\t\t\t\t{selector: \"title,head,body\", rules: true},\r\n\t\t\t\t\t\t{selector: \"body\", rules: true}\r\n\t\t\t\t\t],[\r\n\t\t\t\t\t\t{tag:\"head\"}\r\n\t\t\t\t\t]),\r\n\t\t\t\tresult: \"title,head,body\"\r\n\t\t\t},\r\n\t\t\t{\t\r\n\t\t\t\ttest: this.searchSlicerRules(\"title\",[\r\n\t\t\t\t\t\t{selector: \"head > title\", rules: true},\r\n\t\t\t\t\t\t{selector: \"title\", rules: true}\r\n\t\t\t\t\t],[\r\n\t\t\t\t\t\t{tag:\"head\"}\r\n\t\t\t\t\t]),\r\n\t\t\t\tresult: \"head > title\"\r\n\t\t\t}\r\n\t\t],\r\n\t\tresults = tests.forEach(function(test,index) {\r\n\t\t\tif(test.test.selector !== test.result) {\r\n\t\t\t\tthrow \"Failing test \" + index + \", returns \" + test.test.selector + \" instead of \" + test.result;\r\n\t\t\t}\r\n\t\t});\r\n};\r\n\r\nSlicer.prototype.searchSlicerRules = function(name,rules,elementStack) {\r\n\treturn rules.find(function(rule) {\r\n\t\t// Split and trim the selectors for this rule\r\n\t\treturn !!rule.selector.split(\",\").map(function(selector) {\r\n\t\t\t\treturn selector.trim();\r\n\t\t\t// Find the first selector that matches, if any\r\n\t\t\t}).find(function(selector) {\r\n\t\t\t\t// Split and trim the parts of the selector\r\n\t\t\t\tvar parts = selector.split(\" \").map(function(part) {\r\n\t\t\t\t\treturn part.trim();\r\n\t\t\t\t});\r\n\t\t\t\t// * matches any element\r\n\t\t\t\tif(parts.length === 1 && parts[0] === \"*\") {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\t// Make a copy of the element stack so that we can be destructive\r\n\t\t\t\tvar elements = elementStack.slice(0).concat({tag: name}),\r\n\t\t\t\t\tnextElementMustBeAtTopOfStack = true,\r\n\t\t\t\t\tcurrentPart = parts.length - 1;\r\n\t\t\t\twhile(currentPart >= 0) {\r\n\t\t\t\t\tif(parts[currentPart] === \">\") {\r\n\t\t\t\t\t\tnextElementMustBeAtTopOfStack = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif(!nextElementMustBeAtTopOfStack) {\r\n\t\t\t\t\t\t\twhile(elements.length > 0 && elements[elements.length - 1].tag !== parts[currentPart]) {\r\n\t\t\t\t\t\t\t\telements.pop();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(elements.length === 0 || elements[elements.length - 1].tag !== parts[currentPart]) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telements.pop();\r\n\t\t\t\t\t\tnextElementMustBeAtTopOfStack = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentPart--;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t});\r\n};\r\n\r\nSlicer.prototype.getBaseTiddlerTitle = function(baseTiddlerTitle) {\r\n\tif(baseTiddlerTitle) {\r\n\t\treturn baseTiddlerTitle\t\t\r\n\t} else {\r\n\t\tif(this.sourceTiddlerTitle) {\r\n\t\t\treturn \"Sliced up \" + this.sourceTiddlerTitle + \":\";\r\n\t\t} else {\r\n\t\t\treturn \"SlicedTiddler\";\r\n\t\t}\r\n\t}\r\n};\r\n\r\nSlicer.prototype.getSourceText = function() {\r\n\tif(this.sourceTiddlerTitle) {\r\n\t\tvar tiddler = this.wiki.getTiddler(this.sourceTiddlerTitle);\r\n\t\tif(!tiddler) {\r\n\t\t\tconsole.log(\"Tiddler '\" + this.sourceTiddlerTitle + \"' does not exist\");\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tif(tiddler.fields.type === \"text/html\" || tiddler.fields.type === \"text/xml\" || (tiddler.fields.type || \"\").slice(-4) === \"+xml\") {\r\n\t\t\treturn tiddler.fields.text;\r\n\t\t} else {\r\n\t\t\treturn this.getTiddlerAsHtml(tiddler);\r\n\t\t}\r\n\t} else {\r\n\t\treturn this.sourceText;\r\n\t}\r\n};\r\n\r\nSlicer.prototype.getTiddlerAsHtml = function(tiddler) {\r\n\tvar widgetNode = this.wiki.makeTranscludeWidget(tiddler.fields.title,{\r\n\t\t\tdocument: $tw.fakeDocument,\r\n\t\t\tparseAsInline: false,\r\n\t\t\timportPageMacros: true}),\r\n\t\tcontainer = $tw.fakeDocument.createElement(\"div\");\r\n\twidgetNode.render(container,null);\r\n\treturn [\"<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.1//EN\\\" \\\"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\\\">\",\"<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\">\",\"<head>\",\"</head>\",\"<body>\",container.innerHTML,\"</body>\",\"</html>\"].join(\"\\n\");\r\n};\r\n\r\n\r\nSlicer.prototype.getImmediateParent = function() {\r\n\treturn this.parentStack.slice(-1)[0];\r\n};\r\n\r\nSlicer.prototype.onError = function(e) {\r\n\tconsole.error(\"Sax error: \", e)\r\n\t// Try to resume after errors\r\n\tthis.sax.error = null;\r\n\tthis.sax.resume();\r\n};\r\n\r\nSlicer.prototype.onOpenNamespace = function(info) {\r\n\tthis.namespaces[info.prefix] = info.uri;\r\n};\r\n\r\nSlicer.prototype.onCloseNamespace = function(info) {\r\n};\r\n\r\nSlicer.prototype.onOpenTag = function(node) {\r\n\tvar actions = this.getMatchingSlicerRuleActions(node.name);\r\n\t// Create an anchor if we encounter an ID\r\n\tif(node.attributes.id) {\r\n\t\tthis.insertPrecedingChunk({\r\n\t\t\t\"toc-type\": \"anchor\",\r\n\t\t\t\"title\": this.baseTiddlerTitle + \"-anchor-\" + node.attributes.id.value\r\n\t\t});\r\n\t}\r\n\t// Check for an element that should start a new chunk\r\n\tif(actions.startNewChunk) {\r\n\t\t// If this is a heading, pop off any higher or equal level headings first\r\n\t\tif(actions.isParent && actions.headingLevel) {\r\n\t\t\tvar parentActions = this.getImmediateParent().actions;\r\n\t\t\twhile(parentActions.isParent && parentActions.headingLevel && parentActions.headingLevel >= actions.headingLevel) {\r\n\t\t\t\tthis.parentStack.pop();\r\n\t\t\t\tparentActions = this.getImmediateParent().actions;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Start the new chunk\r\n\t\tthis.startNewChunk(actions.startNewChunk);\r\n\t\t// If this is a parent then also add it to the parent stack\r\n\t\tif(actions.isParent) {\r\n\t\t\tthis.parentStack.push({chunk: this.currentChunk, actions: actions});\r\n\t\t}\r\n\t}\r\n\t// Render the tag inline in the current chunk unless we should ignore it\r\n\tif(!actions.dontRenderTag) {\r\n\t\tif(actions.isImage) {\r\n\t\t\tthis.onOpenImage(node);\r\n\t\t} else if(actions.isAnchor) {\r\n\t\t\tthis.onOpenAnchor(node);\r\n\t\t} else {\r\n\t\t\tvar markupInfo = actions.markup && actions.markup[this.outputMode];\r\n\t\t\tif(markupInfo) {\r\n\t\t\t\tthis.addTextToCurrentChunk(markupInfo.prefix);\r\n\t\t\t} else {\r\n\t\t\t\tthis.addTextToCurrentChunk(\"<\" + node.name + (node.isSelfClosing ? \"/\" : \"\") + \">\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// Remember whether this tag is self closing\r\n\tthis.elementStack.push({tag: node.name,isSelfClosing: node.isSelfClosing, actions: actions, node: node});\r\n};\r\n\r\nSlicer.prototype.onOpenAnchor = function(node) {\r\n\tif(node.attributes.href) {\r\n\t\tvar value = node.attributes.href.value;\r\n\t\tif(value.indexOf(\"https://\") === 0 || value.indexOf(\"http://\") === 0) {\r\n\t\t\t// External link\r\n\t\t\tthis.addTextToCurrentChunk(\"<a href=\\\"\" + value + \"\\\"  target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\">\");\r\n\t\t} else {\r\n\t\t\t// Internal link\r\n\t\t\tvar parts = value.split(\"#\"),\r\n\t\t\t\tbase = parts[0],\r\n\t\t\t\thash = parts[1] || \"\",\r\n\t\t\t\ttitle = $tw.utils.resolvePath(base,this.baseTiddlerTitle) + \"-anchor-\" + hash;\r\n\t\t\tthis.addTextToCurrentChunk(\"<$link to=\\\"\" + title + \"\\\">\");\t\t\t\r\n\t\t}\r\n\t}\r\n};\r\n\r\nSlicer.prototype.onCloseAnchor = function(elementInfo) {\r\n\tif(elementInfo.node.attributes.href) {\r\n\t\tvar value = elementInfo.node.attributes.href.value;\r\n\t\tif(value.indexOf(\"https://\") === 0 || value.indexOf(\"http://\") === 0) {\r\n\t\t\t// External link\r\n\t\t\tthis.addTextToCurrentChunk(\"</a>\");\r\n\t\t} else {\r\n\t\t\t// Internal link\r\n\t\t\tthis.addTextToCurrentChunk(\"</$link>\");\r\n\t\t}\r\n\t}\r\n};\r\n\r\nSlicer.prototype.onOpenImage = function(node) {\r\n\tvar url = node.attributes.src.value;\r\n\tif(url.slice(0,5) === \"data:\") {\r\n\t\t// var parts = url.slice(5).split(\",\");\r\n\t\t// this.chunks.push({\r\n\t\t// \ttitle: ,\r\n\t\t// \ttext: parts[1],\r\n\t\t// \ttype: parts[0].split[\";\"][0],\r\n\t\t// \trole: this.role\r\n\t\t// });\r\n\t}\r\n\tthis.addTextToCurrentChunk(\"[img[\" + $tw.utils.resolvePath(url,this.baseTiddlerTitle) + \"]]\");\r\n};\r\n\r\nSlicer.prototype.onCloseTag = function(name) {\r\n\tvar e = this.elementStack.pop(),\r\n\t\tactions = e.actions,\r\n\t\tselfClosing = e.isSelfClosing;\r\n\t// Set the caption if required\r\n// TODO\r\n// \tif(actions.setCaption) {\r\n// \t\tthis.chunks[this.currentChunk].caption = this.chunks[this.currentChunk].title;\r\n// \t}\r\n\t// Render the tag\r\n\tif(actions.isAnchor) {\r\n\t\tthis.onCloseAnchor(e);\r\n\t} else if (!actions.dontRenderTag && !selfClosing) {\r\n\t\tvar markupInfo = actions.markup && actions.markup[this.outputMode];\r\n\t\tif(markupInfo) {\r\n\t\t\tthis.addTextToCurrentChunk(markupInfo.suffix);\r\n\t\t} else {\r\n\t\t\tthis.addTextToCurrentChunk(\"</\" + name + \">\");\t\t\t\r\n\t\t}\r\n\t}\r\n\t// Check for an element that started a new chunk\r\n\tif(actions.startNewChunk) {\r\n\t\tif(!actions.mergeNext) {\r\n\t\t\tthis.currentChunk = null;\t\t\t\r\n\t\t}\r\n\t\t// If this is a parent and not a heading then also pop it from the parent stack\r\n\t\tif(actions.isParent && !actions.headingLevel) {\r\n\t\t\tthis.parentStack.pop();\r\n\t\t}\r\n\t}\r\n};\r\n\r\nSlicer.prototype.onText = function(text) {\r\n\tvar self = this;\r\n\t// Discard the text if we're inside an element with actions.discard set true\r\n\tif(this.elementStack.some(function(e) {return e.actions.discard;})) {\r\n\t\treturn;\r\n\t}\r\n\t// Optionally escape common character sequences that might be parsed as wikitext\r\n\ttext = $tw.utils.htmlEncode(text);\r\n\tif(this.escapeWikiText) {\r\n\t\t$tw.utils.each([\"[[\",\"{{\",\"__\",\"''\",\"//\",\",,\",\"^^\",\"~~\",\"`\",\"--\",\"\\\"\\\"\",\"@@\"],function(str) {\r\n\t\t\tvar replace = str.split(\"\").map(function(c) {\r\n\t\t\t\treturn \"&#\" + c.charCodeAt(0) + \";\";\r\n\t\t\t}).join(\"\");\r\n\t\t\ttext = text.replace(new RegExp($tw.utils.escapeRegExp(str),\"mg\"),replace);\r\n\t\t});\r\n\t}\r\n\tthis.addTextToCurrentChunk(text);\r\n\tthis.addTextToCurrentChunk(text,\"caption\");\r\n};\r\n\r\nSlicer.prototype.onEnd = function() {\r\n\tthis.callback(null,this.chunks);\r\n};\r\n\r\nSlicer.prototype.addTextToCurrentChunk = function(str,field) {\r\n\tfield = field || \"text\";\r\n\tif(this.currentChunk === null && str.trim() !== \"\") {\r\n\t\tthis.startNewChunk({\r\n\t\t\ttitle: this.makeTitle(\"paragraph\"),\r\n\t\t\t\"toc-type\": \"paragraph\"\r\n\t\t});\r\n\t}\r\n\tif(this.currentChunk !== null) {\r\n\t\tthis.chunks[this.currentChunk][field] += str;\r\n\t}\r\n};\r\n\r\nSlicer.prototype.startNewChunk = function(fields) {\r\n\tvar title = fields.title || this.makeTitle(fields[\"toc-type\"]);\r\n\tvar parentChunk = this.chunks[this.getImmediateParent().chunk];\r\n\tthis.chunks.push($tw.utils.extend({},{\r\n\t\ttitle: title,\r\n\t\ttext: \"\",\r\n\t\tcaption: \"\",\r\n\t\ttags: [parentChunk.title],\r\n\t\tlist: [],\r\n\t\trole: this.role\r\n\t},fields));\r\n\tthis.currentChunk = this.chunks.length - 1;\r\n\tparentChunk.list.push(title);\r\n};\r\n\r\nSlicer.prototype.insertPrecedingChunk = function(fields) {\r\n\tif(!fields.title) {\r\n\t\tthrow \"Chunks need a title\"\r\n\t}\r\n\tif(!this.currentChunk) {\r\n\t\tthis.startNewChunk(fields);\r\n\t\tthis.currentChunk = null;\r\n\t} else {\r\n\t\tvar parentChunk = this.chunks[this.getImmediateParent().chunk],\r\n\t\t\tindex = this.chunks.length - 1;\r\n\t\t// Insert the new chunk\r\n\t\tthis.chunks.splice(index,0,$tw.utils.extend({},{\r\n\t\t\ttext: \"\",\r\n\t\t\tcaption: \"\",\r\n\t\t\ttags: [parentChunk.title],\r\n\t\t\tlist: [],\r\n\t\t\trole: this.role\r\n\t\t},fields));\r\n\t\t// Adjust the current chunk pointer\r\n\t\tthis.currentChunk += 1;\r\n\t\t// Insert a pointer to the new chunk in the parent\r\n\t\tparentChunk.list.splice(parentChunk.list.length - 1,0,fields.title);\t\t\r\n\t}\r\n};\r\n\r\nSlicer.prototype.isBlank = function(s) {\r\n\treturn (/^[\\s\\xA0]*$/g).test(s);\r\n};\r\n\r\nSlicer.prototype.makeTitle = function(prefix) {\r\n\tprefix = prefix  || \"\";\r\n\tvar count = (this.titleCounts[prefix] || 0) + 1;\r\n\tthis.titleCounts[prefix] = count;\r\n\treturn this.baseTiddlerTitle + \"-\" + prefix + \"-\" + count;\r\n};\r\n\r\nexports.Slicer = Slicer;\r\n\r\n})();\r\n","type":"application/javascript","module-type":"library"},"$:/plugins/tiddlywiki/text-slicer/modules/startup/slicer-startup.js":{"title":"$:/plugins/tiddlywiki/text-slicer/modules/startup/slicer-startup.js","text":"/*\\\r\ntitle: $:/plugins/tiddlywiki/text-slicer/modules/startup/slicer-startup.js\r\ntype: application/javascript\r\nmodule-type: startup\r\n\r\nSetup the root widget event handlers\r\n\r\n\\*/\r\n(function(){\r\n\r\n/*jslint node: true, browser: true */\r\n/*global $tw: false */\r\n\"use strict\";\r\n\r\nvar textSlicer = require(\"$:/plugins/tiddlywiki/text-slicer/modules/slicer.js\");\r\n\r\n// Export name and synchronous status\r\nexports.name = \"slicer\";\r\nexports.platforms = [\"browser\"];\r\nexports.after = [\"startup\"];\r\nexports.synchronous = true;\r\n\r\n// Install the root widget event handlers\r\nexports.startup = function() {\r\n\t// Check sax is installed\r\n\tif(!$tw.utils.hop($tw.modules.titles,\"$:/plugins/tiddlywiki/sax/sax.js\")) {\r\n\t\t// Make a logger\r\n\t\tvar logger = new $tw.utils.Logger(\"text-slicer\");\r\n\t\tlogger.alert(\"The plugin 'text-slicer' requires the 'sax' plugin to be installed\");\r\n\t}\r\n\t// Add tm-slice-tiddler event handler\r\n\t$tw.rootWidget.addEventListener(\"tm-slice-tiddler\",function(event) {\r\n\t\tvar slicer = new textSlicer.Slicer({\r\n\t\t\tsourceTiddlerTitle: event.param,\r\n\t\t\tslicerRules: event.paramObject && event.paramObject.slicerRules,\r\n\t\t\toutputMode: event.paramObject && event.paramObject.outputMode,\r\n\t\t\tbaseTiddlerTitle: event.paramObject && event.paramObject.destTitle,\r\n\t\t\trole: event.paramObject && event.paramObject.role,\r\n\t\t\twiki: $tw.wiki,\r\n\t\t\tcallback: function(err,tiddlers) {\r\n\t\t\t\tif(err) {\r\n\t\t\t\t\tlogger.alert(\"Slicer error: \" + err);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$tw.wiki.addTiddlers(tiddlers);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n};\r\n\r\n})();\r\n","type":"application/javascript","module-type":"startup"},"$:/plugins/tiddlywiki/text-slicer/styles":{"title":"$:/plugins/tiddlywiki/text-slicer/styles","tags":"$:/tags/Stylesheet","text":"\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline macrocallblock\n\n.tc-document-preview-column {\r\n\tposition: fixed;\r\n\toverflow-y: auto;\r\n\toverflow-x: visible;\r\n\t-webkit-overflow-scrolling: touch;\r\n    background-color: <<colour page-background>>;\r\n\tright: auto;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\tbottom: 0;\r\n\twidth: {{$:/themes/tiddlywiki/vanilla/metrics/storyleft}};\r\n\tfont-size: 0.9em;\r\n}\n\n.tc-sliced-document-title {\r\n\tfont-size: 1.7em;\r\n}\n\n.tc-slice-note {\r\n    color: #800;\r\n    padding: 4px 4px 4px 4px;\r\n    border: 1px solid #feed77;\r\n    background: #feed77;\r\n    background: -webkit-gradient(linear,left top,left bottom,color-stop(0%,#dede80),color-stop(7%,#feed77),color-stop(92%,#feed77),color-stop(100%,#dede80));\r\n    background: -webkit-linear-gradient(72deg,rgba(255, 255, 255, 0.5) 8%,rgba(255, 255, 255, 0.1) 80%), -webkit-linear-gradient(top,#dede80 0,#feed77 7%,#feed77 92%,#dede80 100%);\r\n    background: -moz-linear-gradient(72deg,rgba(255, 255, 255, 0.5) 8%,rgba(255, 255, 255, 0.1) 80%), -moz-linear-gradient(top,#dede80 0,#feed77 7%,#feed77 92%,#dede80 100%);\r\n    background: -o-linear-gradient(72deg,rgba(255, 255, 255, 0.5) 8%,rgba(255, 255, 255, 0.1) 80%), -o-linear-gradient(top,#dede80 0,#feed77 7%,#feed77 92%,#dede80 100%);\r\n    background: -ms-linear-gradient(72deg,rgba(255, 255, 255, 0.5) 8%,rgba(255, 255, 255, 0.1) 80%), -ms-linear-gradient(top,#dede80 0,#feed77 7%,#feed77 92%,#dede80 100%);\r\n    background: linear-gradient(72deg,rgba(255, 255, 255, 0.5) 8%,rgba(255, 255, 255, 0.1) 80%), linear-gradient(top,#dede80 0,#feed77 7%,#feed77 92%,#dede80 100%);\r\n\t<<box-shadow \"1px 1px 6px rgba(0,0,0,0.4)\">>\r\n}\n\n.tc-document-preview-column .tc-sliced-document-header {\r\n\tmargin-left: 24px;\r\n}\n\n.tc-document-preview-column .tc-sliced-document {\r\n\tmargin-bottom: 3px;\r\n}\n\n.tc-view-template-document-tiddler-wrapper,\r\n.tc-edit-template-document-tiddler-wrapper {\r\n    border-top: 2px solid #D6A2A2;\r\n    margin-left: -42px;\r\n    margin-right: -42px;\r\n    margin-bottom: -42px;\r\n    padding-left: 42px;\r\n    padding-right: 42px;\r\n    background: #FFE3E3;\r\n    padding-bottom: 10px;\r\n}\n\n.tc-edit-template-document-tiddler-wrapper {\r\n\tbackground: #A3A3D7;\r\n}\n\ndiv.tc-view-template-document-tiddler-heading a,\r\ndiv.tc-edit-template-document-tiddler-heading a {\r\n\tborder: 1px solid #D6A2A2;\r\n\tbackground: #fff;\r\n\tborder-radius: 16px;\r\n    padding: 0px 4px 0px 4px;\r\n    margin: 2px 4px 2px 4px;\r\n    white-space: nowrap;\r\n    display: inline-block;\r\n}\n\ndiv.tc-view-template-document-tiddler-heading a:hover,\r\ndiv.tc-edit-template-document-tiddler-heading a:hover {\r\n\tborder: 1px solid <<colour background>>;\r\n\ttext-decoration: none;\r\n\tcolor: <<colour background>>;\r\n\tbackground: <<colour foreground>>;\r\n}\n\n.tc-view-template-document-tiddler-heading-icon,\r\n.tc-edit-template-document-tiddler-heading-icon {\r\n\twidth: 42px;\r\n\ttext-align: center;\r\n    margin-left: -42px;\r\n    margin-right: -42px;\r\n    position: absolute;\r\n}\n\n.tc-view-template-document-tiddler-subheading,\r\n.tc-edit-template-document-tiddler-subheading {\r\n\tfont-size: 0.7em;\r\n\tfont-weight: bold;\r\n\tcolor: <<colour muted-foreground>>;\r\n}\n\n.tc-view-template-document-tiddler-heading-icon svg,\r\n.tc-edit-template-document-tiddler-heading-icon svg {\r\n\tfill: <<colour background>>;\t\r\n}\n\n.tc-view-template-document-tiddler {\r\n\tfont-size: 0.9em;\r\n}\n\n.tc-document-tiddler {\r\n\tfont-family: Georgia, Times, 'Times New Roman', serif;\r\n}\n\n.tc-text-slicer-rename input {\r\n\tdisplay: block;\r\n\twidth: 100%;\r\n}\n\n.tc-document-tiddler-link {\r\n\tcursor: pointer;\r\n}\n\n.tc-document-tiddler-link:hover {\r\n    background: <<color background>>;\r\n}\n\n.tc-document-tiddler-toolbar {\r\n\tposition: absolute;\r\n\twidth: 24px;\r\n\ttext-align: center;\r\n}\n\n.tc-document-preview-column .tc-sliced-document-body {\r\n\tmargin-left: 24px;\r\n}\n\n.tc-document-preview-column .tc-document-tiddler-toolbar {\r\n\tmargin-left: -24px;\r\n}\n\n.tc-table-of-contents .tc-slice-toolbar button {\r\n\tcolor: inherit;\r\n\tbackground-color: inherit;\r\n}\n\n.tc-tiddler-frame .tc-document-tiddler-toolbar {\r\n    left: 0;\r\n    width: 42px;\r\n}\n\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/def-list":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/def-list","text":"\\define body()\r\n<dl>\r\n<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\r\n<$list filter={{!!toc-list-filter}} template=\"$:/plugins/tiddlywiki/text-slicer/templates/interactive/tiddler\"/>\r\n</$list>\r\n</dl>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/definition":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/definition","text":"\\define body()\r\n<$link tag=\"dd\" class=\"tc-document-tiddler-link\">\n\n<$transclude/>\n\n</$link>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/document":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/document","text":"\\define config-document-status()\r\n$:/state/plugins/tiddlywiki/text-slicer/show-preview-document/$(tv-heading-status-config-prefix)$/$(currentTiddler)$\r\n\\end\n\n\\define config-show-toolbar()\r\n$:/state/plugins/tiddlywiki/text-slicer/show-toolbar/$(currentTiddler)$\r\n\\end\n\n\\define config-show-metadata()\r\n$:/state/plugins/tiddlywiki/text-slicer/show-metadata/$(currentTiddler)$\r\n\\end\n\n\\define config-heading-status()\r\n$:/state/plugins/tiddlywiki/text-slicer/heading-status/$(currentTiddler)$\r\n\\end\n\n\\define body()\r\n<$set name=\"tv-heading-status-config-title\" value=<<config-heading-status>>>\r\n<$set name=\"tv-show-toolbar\" value={{$(config-show-toolbar)$}}>\r\n<div class=\"tc-sliced-document\">\r\n<div class=\"tc-sliced-document-header\">\r\n<div class=\"tc-document-tiddler-toolbar\">\r\n<$reveal type=\"nomatch\" state=<<config-document-status>> text=\"close\" default=\"open\" tag=\"div\">\r\n<$button set=<<config-document-status>> setTo=\"close\" class=\"tc-btn-invisible\">\r\n{{$:/core/images/down-arrow}}\r\n</$button>\r\n</$reveal>\r\n<$reveal type=\"match\" state=<<config-document-status>> text=\"close\" default=\"open\" tag=\"div\">\r\n<$button set=<<config-document-status>> setTo=\"open\" class=\"tc-btn-invisible\">\r\n{{$:/core/images/right-arrow}}\r\n</$button>\r\n</$reveal>\r\n</div>\r\n<h1 class=\"tc-sliced-document-title\">''Document'': <$link><$view field=\"title\"/></$link></h1>\r\n</div>\r\n<$reveal type=\"nomatch\" state=<<config-document-status>> text=\"close\" default=\"open\" tag=\"div\">\r\n{{||$:/plugins/tiddlywiki/text-slicer/ui/document/header}}\r\n<div class='tc-sliced-document-body'>\r\n<$set name=\"tv-show-toolbar\" value={{$(config-show-toolbar)$}}>\r\n<$set name=\"tv-exclude-filter\" value={{!!toc-exclude-filter}}>\r\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/interactive/tiddler\"/>\r\n</$set>\r\n</$set>\r\n</div>\r\n</$reveal>\r\n</div>\r\n</$set>\r\n</$set>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/heading":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/heading","text":"\\define config-heading-status()\r\n$(tv-heading-status-config-title)$/$(tv-heading-status-config-prefix)$/$(currentTiddler)$\r\n\\end\n\n\\define body(level:\"h1\")\r\n<$set name=\"tv-heading-status-config-title\" value=<<config-heading-status>>>\r\n<div class=\"tc-document-tiddler\">\r\n<div class=\"tc-document-tiddler-toolbar\">\r\n<$reveal type=\"nomatch\" state=<<tv-heading-status-config-title>> text=\"close\" default=<<tv-default-heading-state>> tag=\"div\">\r\n<$button set=<<tv-heading-status-config-title>> setTo=\"close\" class=\"tc-btn-invisible\">\r\n{{$:/core/images/down-arrow}}\r\n</$button>\r\n</$reveal>\r\n<$reveal type=\"match\" state=<<tv-heading-status-config-title>> text=\"close\" default=<<tv-default-heading-state>> tag=\"div\">\r\n<$button set=<<tv-heading-status-config-title>> setTo=\"open\" class=\"tc-btn-invisible\">\r\n{{$:/core/images/right-arrow}}\r\n</$button>\r\n</$reveal>\r\n</div>\r\n<$link tag=\"$level$\" class=\"tc-document-tiddler-link\">\r\n<$transclude/>\r\n</$link>\r\n<$reveal type=\"nomatch\" state=<<tv-heading-status-config-title>> text=\"close\" default=<<tv-default-heading-state>> tag=\"div\">\r\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/interactive/tiddler\"/>\r\n</$reveal>\r\n</div>\r\n</$set>\r\n\\end\n\n<$macrocall $name=\"body\" level={{!!toc-heading-level}}/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/image":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/image","text":"\\define body()\r\n<$link tag=\"div\" class=\"tc-document-tiddler-link tc-document-tiddler\">\n\n<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\n\n<$transclude/>\n\n</$list>\n\n</$link>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/item":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/item","text":"\\define body()\r\n<$link tag=\"li\" class=\"tc-document-tiddler-link\">\n\n<$transclude/>\n\n</$link>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/list":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/list","text":"\\define body(type:\"ul\")\r\n<$type$>\r\n<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\r\n<$list filter={{!!toc-list-filter}} template=\"$:/plugins/tiddlywiki/text-slicer/templates/interactive/tiddler\"/>\r\n</$list>\r\n</$type$>\r\n\\end\n\n<$macrocall $name=\"body\" type={{!!toc-list-type}}/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/note":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/note","text":"\\define body()\r\n<div class=\"tc-slice-note\">\n\n<$link tag=\"div\" class=\"tc-document-tiddler-link tc-document-tiddler\">\n\n<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\n\n<$transclude/>\n\n</$list>\n\n</$link>\n\n</div>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/paragraph":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/paragraph","text":"\\define body()\r\n<$link tag=\"div\" class=\"tc-document-tiddler-link tc-document-tiddler\">\n\n<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\n\n<$transclude/>\n\n</$list>\n\n</$link>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/term":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/term","text":"\\define body()\r\n<$link tag=\"dt\" class=\"tc-document-tiddler-link\">\n\n<$transclude/>\n\n</$link>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/interactive/tiddler":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/interactive/tiddler","text":"\\define if(condition,then,else)\r\n<$list filter=\"\"\"$condition$ +[limit[1]]\"\"\" emptyMessage=\"\"\"$else$\"\"\" variable=\"ignore\">\r\n$then$\r\n</$list>\r\n\\end\n\n\\define include-component(type)\r\n<<if \"[{!!toc-type}prefix[$type$]]\" \"\"\"\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/interactive/$type$\" mode=\"block\"/>\r\n\"\"\">>\r\n\\end\n\n<$list filter=\"[<tv-show-toolbar>prefix[yes]]\" variable=\"hasToolbar\">\r\n{{||$:/plugins/tiddlywiki/text-slicer/ui/tiddler/toolbar}}\r\n</$list>\n\n<<include-component \"document\">>\r\n<<include-component \"heading\">>\r\n<<include-component \"paragraph\">>\r\n<<include-component \"note\">>\r\n<<include-component \"list\">>\r\n<<include-component \"item\">>\r\n<<include-component \"image\">>\r\n<<include-component \"def-list\">>\r\n<<include-component \"term\">>\r\n<<include-component \"definition\">>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/def-list":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/def-list","text":"\\define body()\r\n<dl>\r\n<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\r\n<$list filter={{!!toc-list-filter}} template=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/tiddler\"/>\r\n</$list>\r\n</dl>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/definition":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/definition","text":"\\define body()\r\n<dd>\n\n<$transclude/>\n\n</dd>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/document":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/document","text":"<$set name=\"tv-exclude-filter\" value={{!!toc-exclude-filter}}>\n\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/tiddler\"/>\n\n</$set>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/heading":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/heading","text":"\\define body(level:\"h1\")\r\n<$level$>\r\n<$transclude/>\r\n</$level$>\r\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/tiddler\"/>\r\n\\end\n\n<$macrocall $name=\"body\" level={{!!toc-heading-level}}/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/image":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/image","text":"<$transclude/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/item":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/item","text":"\\define body()\r\n<li>\n\n<$transclude/>\n\n</li>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/list":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/list","text":"\\define body(type:\"ul\")\r\n<$type$>\r\n<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\r\n<$list filter={{!!toc-list-filter}} template=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/tiddler\"/>\r\n</$list>\r\n</$type$>\r\n\\end\n\n<$macrocall $name=\"body\" type={{!!toc-list-type}}/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/note":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/note","text":"<!-- Don't display notes in plain mode -->\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/paragraph":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/paragraph","text":"\\define body()\r\n<div>\n\n<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\n\n<$transclude/>\n\n</$list>\n\n</div>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/term":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/term","text":"\\define body()\r\n<dt>\n\n<$transclude/>\n\n</dt>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/plain/tiddler":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/plain/tiddler","text":"<$vars toc-type={{!!toc-type}}>\n\n<$list filter=\"[<toc-type>prefix[document]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/document\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[heading]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/heading\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[paragraph]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/paragraph\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[note]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/note\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[list]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/list\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[item]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/item\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[image]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/image\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[def-list]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/def-list\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[term]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/term\" mode=\"block\"/>\r\n</$list>\n\n<$list filter=\"[<toc-type>prefix[definition]]\" variable=\"item\">\r\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/definition\" mode=\"block\"/>\r\n</$list>\n\n</$vars>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/def-list":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/def-list","text":"<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\n\n`<dl class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n<$list filter={{!!toc-list-filter}} template=\"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler\"/>\n\n`</dl>`\n\n</$list>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/definition":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/definition","text":"`<dd class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n<$transclude/>\n\n`</dd>`\n\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler\"/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/document":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/document","text":"<$set name=\"tv-exclude-filter\" value={{!!toc-exclude-filter}}>\n\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler\"/>\n\n</$set>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/heading":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/heading","text":"`<`<$text text={{!!toc-heading-level}}/>` class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n<$view field=\"text\" format=\"htmlencodedplainwikified\"/>\n\n`</`<$text text={{!!toc-heading-level}}/>`>`\n\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler\"/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes","text":"<$list filter=\"[all[current]tags[]addprefix[$:/_DocumentTags/]has[title]]\"><$view field=\"css-class\"/> </$list>"},"$:/plugins/tiddlywiki/text-slicer/templates/static/image":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/image","text":"<$reveal state=\"!!_canonical_uri\" type=\"match\" text=\"\">\n\n`<img src=\"data:`<$view format=\"text\" field=\"type\"/>`;base64,`<$view format=\"text\" field=\"text\"/>`\" class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n</$reveal>\n\n<$reveal state=\"!!_canonical_uri\" type=\"nomatch\" text=\"\">\n\n`<img src=\"`<$text text=<<tv-external-image-path>>/><$view field=\"title\" format=\"doubleurlencoded\"/>`\" class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n</$reveal>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/item":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/item","text":"`<li class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n<$transclude/>\n\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler\"/>\n\n`</li>`\n\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/list":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/list","text":"<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\n\n`<`<$text text={{!!toc-list-type}}/>` class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n<$list filter={{!!toc-list-filter}} template=\"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler\"/>\n\n`</`<$text text={{!!toc-list-type}}/>`>`\n\n</$list>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/note":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/note","text":"<!-- Don't display notes in static mode -->\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/paragraph":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/paragraph","text":"<$list filter=\"\"\"[all[current]] $(tv-exclude-filter)$ +[limit[1]]\"\"\" variable=\"item\">\n\n`<p class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n<$view field=\"text\" format=\"htmlencodedplainwikified\"/>\n\n`</p>`\n\n</$list>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/term":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/term","text":"`<dt class=\"`{{||$:/plugins/tiddlywiki/text-slicer/templates/static/helpers/classes}}`\">`\n\n<$transclude/>\n\n`</dt>`\n\n<$list filter=\"[list<currentTiddler>!has[draft.of]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler\"/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler":{"title":"$:/plugins/tiddlywiki/text-slicer/templates/static/tiddler","text":"<$vars toc-type={{!!toc-type}}>\n\n<$list filter=\"[<toc-type>prefix[document]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/document\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[heading]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/heading\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[paragraph]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/paragraph\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[note]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/note\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[list]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/list\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[item]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/item\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[image]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/image\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[def-list]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/def-list\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[term]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/term\" mode=\"block\"/>\n\n</$list>\n\n<$list filter=\"[<toc-type>prefix[definition]]\" variable=\"item\">\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/static/definition\" mode=\"block\"/>\n\n</$list>\n\n</$vars>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/document/header":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/document/header","text":"\\define metadatafield()\r\n<tr>\r\n<td>\r\n''<$transclude tiddler=<<listItem>> field=\"caption\"/>''\r\n</td>\r\n<td>\r\n<$reveal type=\"match\" state=\"\"\"$(listItem)$!!field-type\"\"\" text=\"string\">\r\n<$edit-text field={{$(listItem)$!!field}}/>\r\n</$reveal>\r\n<$reveal type=\"match\" state=\"\"\"$(listItem)$!!field-type\"\"\" text=\"list\">\r\n<$edit-text tag=\"textarea\" field={{$(listItem)$!!field}}/>\r\n</$reveal>\r\n</td>\r\n</tr>\r\n\\end\n\n<div class=\"tc-sliced-document-header\">\n\n''Exclude filter'': <$edit-text field=\"toc-exclude-filter\"/>\n\n<$checkbox tiddler=<<config-show-toolbar>> field=\"text\" checked=\"yes\" unchecked=\"no\" default=\"no\"> Show toolbar </$checkbox> <$checkbox tiddler=<<config-show-metadata>> field=\"text\" checked=\"yes\" unchecked=\"no\" default=\"no\"> Show metadata</$checkbox> <$button>\r\n<$action-sendmessage $message=\"tm-open-window\" $param=<<currentTiddler>> template=\"$:/plugins/tiddlywiki/text-slicer/templates/plain/document\"/>\r\nView document\r\n</$button>\n\n<$reveal state=<<config-show-metadata>> default=\"no\" type=\"match\" text=\"yes\">\r\n<table>\r\n<tbody>\r\n<$list filter=\"[all[system+tiddlers]tag[$:/tags/DocumentMetaData]]\" variable=\"listItem\">\r\n<<metadatafield>>\r\n</$list>\r\n</tbody>\r\n</table>\r\n</$reveal>\n\n\r\n</div>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/edit-template-segment":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/edit-template-segment","tags":"$:/tags/EditTemplate","text":"\\define edit-field(name,tag:\"input\")\r\n$name$:\n\n<$edit-text field=\"\"\"$name$\"\"\" tag=\"$tag$\" class=\"tc-edit-texteditor\"/>\r\n\\end\n\n<$reveal type=\"nomatch\" state=\"!!toc-type\" text=\"\">\n\n<div class=\"tc-edit-template-document-tiddler-wrapper\">\n\n<div class=\"tc-edit-template-document-tiddler-heading\">\n\n<div class=\"tc-edit-template-document-tiddler-heading-icon\">\n\n{{$:/core/images/file}}\n\n</div>\n\n<div class=\"tc-edit-template-document-tiddler-subheading\">\n\n<$view field=\"toc-type\"/>\n\n</div>\n\n<<edit-field \"list\" tag:\"textarea\">>\n\n</div>\n\n</div>\n\n</$reveal>\n\n"},"$:/plugins/tiddlywiki/text-slicer/filters/Orphans":{"title":"$:/plugins/tiddlywiki/text-slicer/filters/Orphans","tags":"$:/tags/Filter","filter":"[has[toc-type]] -[toc-type[document]list-children[]]","description":"[Text-slicer] Tiddlers that are not part of any document","text":""},"$:/plugins/tiddlywiki/text-slicer/ui/preview-column/empty":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/preview-column/empty","text":"<div class=\"tc-sliced-document-header\">\n\nCreate a document by slicing an existing tiddler\n\n---\n\n[[Help|$:/plugins/tiddlywiki/text-slicer/docs]]\n\n</div>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/preview-column/multiple":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/preview-column/multiple","text":"Show document: <$select tiddler=\"$:/plugins/tiddlywiki/text-slicer/config/currentDocument\">\r\n<$list filter=\"[toc-type[document]!has[draft.of]sort[title]]\">\r\n<option value=<<currentTiddler>>><$view field=\"title\"/></option>\r\n</$list>\r\n</$select>\n\n<$tiddler tiddler={{$:/plugins/tiddlywiki/text-slicer/config/currentDocument}}>\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/interactive/document\"/>\n\n</$tiddler>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/preview-column/single":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/preview-column/single","text":"<$list filter=\"[toc-type[document]!has[draft.of]sort[title]limit[1]]\" template=\"$:/plugins/tiddlywiki/text-slicer/templates/interactive/document\"/>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/preview-column":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/preview-column","tags":"$:/tags/AboveStory","text":"<$scrollable fallthrough=\"no\" class=\"tc-document-preview-column\">\n\n<$vars\r\n\ttv-default-heading-state=\"open\"\r\n>\n\n<$list filter=\"[toc-type[document]!has[draft.of]sort[title]limit[1]]\" emptyMessage={{$:/plugins/tiddlywiki/text-slicer/ui/preview-column/empty}}>\n\n<$list filter=\"[toc-type[document]!has[draft.of]sort[title]butfirst[1]limit[1]]\" emptyMessage={{$:/plugins/tiddlywiki/text-slicer/ui/preview-column/single}} template=\"$:/plugins/tiddlywiki/text-slicer/ui/preview-column/multiple\"/>\n\n</$list>\n\n</$vars>\n\n</$scrollable>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/slice-modal":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/slice-modal","footer":"<$button message=\"tm-close-tiddler\">Cancel</$button> <$button><$action-sendmessage $message=\"tm-close-tiddler\"/><$action-sendmessage $message=\"tm-slice-tiddler\" $param=<<currentTiddler>> slicerRules={{$:/config/plugins/text-slicer/slice-rule}} outputMode={{$:/config/plugins/text-slicer/output-mode}} destTitle={{$:/config/plugins/text-slicer/base-title}}/>Slice</$button>","subtitle":"Slicing \"<$text text=<<currentTiddler>>/>\" into chunks","text":"''Choose how the tiddler should be sliced''\n\nPrefix for extracted tiddlers: <$edit-text tiddler=\"$:/config/plugins/text-slicer/base-title\" default={{{ [[Sliced up ]addsuffix<currentTiddler>addsuffix[:]] }}} tag=\"input\" size=\"30\"/>\n\n<$select tiddler=\"$:/config/plugins/text-slicer/slice-rule\" default=\"html-by-paragraph\">\r\n<$list filter=\"[all[shadows+tiddlers]tag[$:/tags/text-slicer/slicer-rules]!has[draft.of]]\">\r\n<option value={{!!name}}><$text text={{!!description}}/></option>\r\n</$list>\r\n</$select>\n\nOutput mode: <$select tiddler=\"$:/config/plugins/text-slicer/output-mode\" default=\"html\">\r\n<option value=\"html\">HTML</option>\r\n<option value=\"wiki\">Wiki text</option>\r\n</$select>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/slice-toolbar-button":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/slice-toolbar-button","tags":"$:/tags/ViewToolbar","list-before":"$:/core/ui/Buttons/edit","caption":"{{$:/plugins/tiddlywiki/text-slicer/images/text-slicer-icon}} Slice text tiddler","description":"Slice this text tiddler by headings and lists","text":"\\whitespace trim\n\n\\define hint()\r\nSlice this text tiddler into chunks\r\n\\end\n\n<$button tooltip=<<hint>> aria-label=<<hint>> class=<<tv-config-toolbar-class>>>\r\n<$action-sendmessage $message=\"tm-modal\" $param=\"$:/plugins/tiddlywiki/text-slicer/ui/slice-modal\" currentTiddler=<<currentTiddler>>/>\r\n<$list filter=\"[<tv-config-toolbar-icons>prefix[yes]]\">\r\n{{$:/plugins/tiddlywiki/text-slicer/images/text-slicer-icon}}\r\n</$list>\r\n<$list filter=\"[<tv-config-toolbar-text>prefix[yes]]\">\r\n<span class=\"tc-btn-text\"> Slice tiddler</span>\r\n</$list>\r\n</$button>"},"$:/plugins/tiddlywiki/text-slicer/ui/tiddler/toolbar/title":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/tiddler/toolbar/title","tags":"$:/tags/TextSlicerToolbar","text":"\\define renameProxyTitle()\r\n$:/state/plugins/tiddlywiki/text-slicer/rename-$(currentTiddler)$\r\n\\end\n\n\\define body()\r\n<div class=\"tc-text-slicer-rename\">\r\n<$edit-text tag=\"input\" tiddler=<<renameProxyTitle>> placeholder=\"Rename\" default=<<currentTiddler>>/>\r\n<$reveal type=\"nomatch\" state=\"\"\"$(renameProxyTitle)$\"\"\" text=<<currentTiddler>> default=<<currentTiddler>>>\r\n<$button>\r\n<$action-deletetiddler $tiddler=<<renameProxyTitle>>/>\r\ncancel\r\n</$button>\r\n<$button>\r\n<$action-sendmessage $message=\"tm-rename-tiddler\" from=<<currentTiddler>> to={{$(renameProxyTitle)$}}/>\r\n<$action-deletetiddler $tiddler=<<renameProxyTitle>>/>\r\nrename\r\n</$button>\r\n<$set name=\"proxy-title\" value={{$(renameProxyTitle)$}}>\r\n<$list filter=\"\"\"[<proxy-title>is[tiddler]]\"\"\">\r\nWarning: tiddler already exists\r\n</$list>\r\n</$set>\r\n</$reveal>\r\n</div>\r\n\\end\n\n<<body>>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/tiddler/toolbar":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/tiddler/toolbar","text":"<div class=\"tc-slice-toolbar\">\r\n<$list filter=\"[all[shadows+tiddlers]tag[$:/tags/TextSlicerToolbar]!has[draft.of]]\" variable=\"listItem\"><$transclude tiddler=<<listItem>>/></$list>\r\n</div>\r\n"},"$:/plugins/tiddlywiki/text-slicer/ui/view-template-segment":{"title":"$:/plugins/tiddlywiki/text-slicer/ui/view-template-segment","tags":"$:/tags/ViewTemplate","text":"\\define config-heading-status()\r\n$:/state/plugins/tiddlywiki/text-slicer/heading-status/$(currentTiddler)$\r\n\\end\n\n<$reveal type=\"nomatch\" state=<<folded-state>> text=\"hide\" retain=\"yes\" animate=\"yes\">\n\n<$reveal type=\"nomatch\" state=\"!!toc-type\" text=\"\">\n\n<div class=\"tc-view-template-document-tiddler-wrapper\">\n\n<div class=\"tc-view-template-document-tiddler-heading\">\n\n<div class=\"tc-view-template-document-tiddler-heading-icon\">\n\n{{$:/core/images/file}}\n\n</div>\n\n<div class=\"tc-view-template-document-tiddler-subheading\">\n\n<$view field=\"toc-type\"/>\n\n</div>\n\nParents: <$list filter=\"[all[current]listed[]!is[system]]\" emptyMessage=\"None\">\r\n<$link><$view field=\"title\"/></$link>\r\n</$list>\n\n</div>\n\n<div class=\"tc-view-template-document-tiddler\">\n\n<$vars\r\n\ttv-default-heading-state=\"close\"\r\n\ttv-heading-status-config-prefix=\"view-template\"\r\n\ttv-heading-status-config-title=<<config-heading-status>>\r\n>\n\n<$transclude tiddler=\"$:/plugins/tiddlywiki/text-slicer/templates/interactive/tiddler\"/>\n\n</$vars>\n\n</div>\n\n</div>\n\n</$reveal>\n\n</$reveal>\r\n"}}}